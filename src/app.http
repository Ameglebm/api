### üé¨ CINEMA TICKET API - Endpoints

@baseUrl = http://localhost:3000

### üè• HEALTH CHECK
### Health Check da API
GET {{baseUrl}}
Content-Type: application/json

### üìã SESSIONS - Gest√£o de Sess√µes
### Criar nova sess√£o
POST {{baseUrl}}/sessions
Content-Type: application/json

{
  "movie": "Avatar: O Caminho da √Ågua",
  "room": "Sala 3",
  "startsAt": "2026-02-20T19:00:00.000Z",
  "ticketPrice": 25.00,
  "totalSeats": 20
}

### Listar todas as sess√µes
GET {{baseUrl}}/sessions
Content-Type: application/json

### Buscar sess√£o por ID
@sessionId = SESSION_ID_AQUI
GET {{baseUrl}}/sessions/{{sessionId}}
Content-Type: application/json

### üí∫ SEATS - Disponibilidade de Assentos
### Listar assentos de uma sess√£o (tempo real)
@sessionIdForSeats = SESSION_ID_AQUI
GET {{baseUrl}}/seats/{{sessionIdForSeats}}
Content-Type: application/json

### üéüÔ∏è RESERVATIONS - Reservas Tempor√°rias
### Criar nova reserva (TTL 30s)
POST {{baseUrl}}/reservations
Content-Type: application/json

{
  "seatId": "SEAT_ID_AQUI",
  "userId": "user-123"
}

### Consultar status de uma reserva
@reservationId = RESERVATION_ID_AQUI
GET {{baseUrl}}/reservations/{{reservationId}}
Content-Type: application/json

### üí≥ PAYMENTS - Confirma√ß√£o de Pagamento
### Confirmar pagamento de uma reserva
@reservationIdForPayment = RESERVATION_ID_AQUI
POST {{baseUrl}}/payments/confirm/{{reservationIdForPayment}}
Content-Type: application/json

### üí∞ SALES - Hist√≥rico de Vendas
### Buscar hist√≥rico de compras por usu√°rio
@userId = user-123
GET {{baseUrl}}/sales/history/{{userId}}
Content-Type: application/json

### üìò SWAGGER - Documenta√ß√£o Interativa
### Abrir Swagger UI (cole no navegador)
### http://localhost:3000/api/docs

### üß™ TESTES DE CONCORR√äNCIA
### TESTE 1: Criar sess√£o
# @name createSession
POST {{baseUrl}}/sessions
Content-Type: application/json

{
  "movie": "Teste Concorr√™ncia",
  "room": "Sala 1",
  "startsAt": "2026-02-20T21:00:00.000Z",
  "ticketPrice": 30.00,
  "totalSeats": 2
}

### TESTE 2: Pegar ID da sess√£o criada
@testSessionId = {{createSession.response.body.id}}

### TESTE 3: Listar assentos da sess√£o de teste
GET {{baseUrl}}/seats/{{testSessionId}}
Content-Type: application/json

### TESTE 4: Usu√°rio 1 tenta reservar assento A1
# @name reservation1
POST {{baseUrl}}/reservations
Content-Type: application/json

{
  "seatId": "COPIAR_SEAT_ID_DO_TESTE_3",
  "userId": "user-001"
}

### TESTE 5: Usu√°rio 2 tenta reservar o MESMO assento A1 (deve retornar 409 Conflict)
POST {{baseUrl}}/reservations
Content-Type: application/json

{
  "seatId": "MESMO_SEAT_ID_DO_TESTE_4",
  "userId": "user-002"
}

### TESTE 6: Confirmar pagamento da reserva do usu√°rio 1
@testReservationId = {{reservation1.response.body.id}}
POST {{baseUrl}}/payments/confirm/{{testReservationId}}
Content-Type: application/json

### TESTE 7: Verificar que o assento agora est√° SOLD
GET {{baseUrl}}/seats/{{testSessionId}}
Content-Type: application/json

### TESTE 8: Hist√≥rico de compras do usu√°rio 1
GET {{baseUrl}}/sales/history/user-001
Content-Type: application/json

### üìä RABBITMQ - Painel de Gerenciamento
### Abrir RabbitMQ Management UI (cole no navegador)
### http://localhost:15672
### User: guest
### Password: guest

### üß† REDIS - Verificar Locks (via redis-cli)

### No terminal, dentro do container Redis:
### docker exec -it cinema-redis redis-cli
### KEYS seat:*
### TTL seat:SEAT_ID_AQUI
### GET seat:SEAT_ID_AQUI

### üìù NOTAS
### ============================================
###
### 1. Substitua SESSION_ID_AQUI, SEAT_ID_AQUI, etc. pelos valores reais
### 2. Use a se√ß√£o de TESTES DE CONCORR√äNCIA para validar race conditions
### 3. O Swagger est√° dispon√≠vel em /api/docs para testes interativos
### 4. Locks Redis expiram automaticamente em 30 segundos
### 5. Reservas n√£o confirmadas expiram e liberam o assento
###
### ============================================